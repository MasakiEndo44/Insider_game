# アイコン統合実装計画書（最適化版）

**プロジェクト名**: インサイダーゲーム - アイコン統合
**計画バージョン**: 2.0（Gemini分析反映版）
**作成日**: 2025-10-21
**実装期間**: 7日間（バッファ含む）
**ステータス**: 実行準備完了

---

## 📋 エグゼクティブサマリー

### プロジェクト目標

`/icon` ディレクトリのPNGアイコン9個をSVGに変換し、lucide-reactとの統一インターフェースでReact/Next.jsプロジェクトに統合する。

### 主要成果物

| 成果物 | 数量 | 品質基準 |
|--------|------|---------|
| **カスタムSVGアイコン** | 9個 | < 2KB/個、currentColor対応 |
| **IconBaseコンポーネント** | 1個 | 統一API、アクセシビリティ自動化 |
| **統合済み画面** | 4画面 | ロビー、投票、ステータスUI、ブランディング |
| **品質スコア** | - | Lighthouse A11y ≥ 95、バンドル < 20KB |

### 重要な変更点（v1.0 → v2.0）

| 項目 | v1.0（当初案） | v2.0（最適化版） |
|------|--------------|----------------|
| **実装期間** | 6日間 | **7日間**（バッファ+1日） |
| **フェーズ構成** | Phase 1-5 | **Phase 0-5 + Buffer** |
| **SVG作成戦略** | Phase毎に逐次実施 | **全期間並行実施** |
| **最大ボトルネック** | 未対策 | **Phase 0で仕様確定、並列化** |

---

## 🗓️ 最適化された7日間スケジュール

### 全体タイムライン

```
Day 1        Day 2       Day 3       Day 4       Day 5       Day 6       Day 7
┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐
│ Phase 0 │ │ Phase 1 │ │ Phase 2 │ │ Phase 3 │ │ Phase 4 │ │ Phase 5 │ │ Buffer  │
│ 仕様確定│ │ 基盤構築│ │UI統合   │ │ブランド │ │QA・最適 │ │最終調整 │ │予備日   │
└─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘
    │           │           │           │           │           │           │
    └───────────┴───────────┴───────────┴───────────┴───────────┴───────────┘
                    全期間並行: SVG作成（デザイナー/専門担当者）
```

### フェーズ別サマリー

| Phase | 期間 | 主要成果物 | 担当分担可能性 |
|-------|------|-----------|--------------|
| **Phase 0** | Day 1 | 仕様確定、IconBaseプロトタイプ、SVG作成開始 | ✅ 高（2-3名） |
| **Phase 1** | Day 2 | IconBase完成、役割アイコン統合 | ✅ 高（2名） |
| **Phase 2** | Day 3 | ロビー・投票画面統合 | ✅ 高（2名） |
| **Phase 3** | Day 4 | ロゴ・Favicon実装 | 🟡 中（1-2名） |
| **Phase 4** | Day 5 | QA・パフォーマンス最適化 | 🟡 中（1-2名） |
| **Phase 5** | Day 6 | 最終調整・ドキュメント | ✅ 高（全員） |
| **Buffer** | Day 7 | 遅延吸収・追加改善 | ✅ 高（全員） |

---

## 📊 Phase別詳細タスク分解

### Phase 0: 準備と仕様確定（Day 1）

**目的**: ボトルネックとなるSVG作成を早期開始し、実装の手戻りを防ぐ

#### タスク一覧

| # | タスク | 担当 | 所要時間 | 並列可能 | 成果物 |
|---|--------|------|---------|---------|--------|
| **0.1** | 全アイコン要件分析 | リード開発者 | 1h | ❌ | 要件マトリクス |
| **0.2** | SVGスタイルガイド作成 | デザイナー | 1h | ✅（0.1後） | スタイルガイド文書 |
| **0.3** | IconBaseプロトタイプ開発 | フロントエンド | 3h | ✅（0.2と並行） | icon-base.tsx（初版） |
| **0.4** | プロトタイプ仮統合 | フロントエンド | 1h | ❌（0.3後） | 動作検証済みUI |
| **0.5** | IconBase API仕様確定 | 全員レビュー | 1h | ❌（0.4後） | 最終仕様書 |
| **0.6** | SVG作成開始（全9個） | **デザイナー** | **開始** | ✅（0.2後から継続） | **Day 1-6並行作業** |

#### 重要な決定事項（Day 1 End）

- [ ] IconBase PropsのTypeScript型定義確定
- [ ] currentColor vs マルチカラーの使い分けルール確定
- [ ] SVGファイル命名規則・ディレクトリ構造確定
- [ ] aria-label必須化の方針確定

#### リスク対策

| リスク | 対策 |
|--------|------|
| SVGスタイルガイドが不明確 | lucide-reactの既存アイコンを分析し、ストローク幅・cap/joinを統一 |
| IconBase仕様の手戻り | プロトタイプで1-2箇所に仮統合し、実用性を早期検証 |

---

### Phase 1: 基盤構築と主要アイコン統合（Day 2）

**目的**: IconBase完成とクリティカルな役割アイコンの実戦投入

#### タスク一覧

| # | タスク | 担当 | 所要時間 | 依存 | 成果物 |
|---|--------|------|---------|------|--------|
| **1.1** | IconBase完成版実装 | フロントエンド | 2h | 0.5 | icon-base.tsx（最終版） |
| **1.2** | lucide-react再エクスポート | フロントエンド | 0.5h | 1.1 | lucide/index.ts |
| **1.3** | 役割アイコンSVG完成待機 | デザイナー | **継続** | 0.6 | master/insider/common.svg |
| **1.4** | 役割アイコンTSX化 | フロントエンド | 1h | 1.1, 1.3 | custom/master-icon.tsx 等 |
| **1.5** | バレルファイル作成 | フロントエンド | 0.5h | 1.2, 1.4 | icons/index.ts |
| **1.6** | ロビー画面統合（PlayerChip） | フロントエンド | 2h | 1.5 | 更新済み lobby/page.tsx |
| **1.7** | ユニットテスト作成 | フロントエンド | 1h | 1.1 | icon-base.test.tsx |
| **1.8** | svgo設定・自動化 | フロントエンド | 0.5h | - | svgo.config.js + husky設定 |

#### 並列実行マトリクス

```
時間  0h   1h   2h   3h   4h   5h   6h   7h   8h
1.1  ├────┤
1.2          ├┤
1.3  ├──────────────────────────────────────┤ (継続)
1.4              ├────┤
1.5                   ├┤
1.6                       ├──────────┤
1.7  (並行)                  ├──────┤
1.8  (並行)      ├┤
```

#### 成果物チェックリスト

- [ ] IconBase完成版がすべてのPropsをサポート
- [ ] 役割アイコン3個がロビー画面で表示
- [ ] aria-label自動設定が機能
- [ ] svgo pre-commitフックが動作
- [ ] ユニットテストが全Pass

---

### Phase 2: UI統合（Day 3）

**目的**: 残りの画面へのアイコン統合とステータスUI実装

#### タスク一覧

| # | タスク | 担当 | 所要時間 | 依存 | 成果物 |
|---|--------|------|---------|------|--------|
| **2.1** | ステータスアイコンSVG完成待機 | デザイナー | **継続** | 0.6 | timer/conversation/network.svg |
| **2.2** | ステータスアイコンTSX化 | フロントエンド | 1h | 2.1 | custom/timer-icon.tsx 等 |
| **2.3** | 投票画面統合 | フロントエンド A | 2h | 1.5 | vote/page.tsx |
| **2.4** | ヘッダー・ステータスバー統合 | フロントエンド B | 2h | 2.2 | header/status-bar 等 |
| **2.5** | 役職配布画面統合 | フロントエンド A | 1h | 1.5 | deal/page.tsx |
| **2.6** | 色覚異常シミュレーション | QA | 1h | 1.6, 2.3 | シミュレーション結果レポート |

#### 並列実行戦略

```
フロントエンドA: 2.3 投票画面 → 2.5 役職配布画面
フロントエンドB: 2.4 ヘッダー・ステータスバー
QA: 2.6 色覚異常シミュレーション（2.3完了後）
```

#### 成果物チェックリスト

- [ ] 投票画面で役割アイコン表示
- [ ] ヘッダーでフェーズアイコン表示
- [ ] ステータスバーでタイマー・接続状態表示
- [ ] 色覚異常シミュレーション合格（3役職区別可能）

---

### Phase 3: ブランディングと特殊ケース対応（Day 4）

**目的**: ロゴ・Favicon実装とマルチカラーアイコンへの対応

#### タスク一覧

| # | タスク | 担当 | 所要時間 | 依存 | 成果物 |
|---|--------|------|---------|------|--------|
| **3.1** | ロゴSVG完成待機 | デザイナー | **継続** | 0.6 | Insider_eye_logo_1.svg |
| **3.2** | トップページロゴ統合 | フロントエンド | 1.5h | 3.1 | top/page.tsx + pulse-glow |
| **3.3** | Favicon生成（多サイズ） | デザイナー | 1h | 3.1 | 512/180/32/16px |
| **3.4** | Favicon統合（Next.js） | フロントエンド | 0.5h | 3.3 | app/icon.tsx |
| **3.5** | ローディング画面統合 | フロントエンド | 1h | 3.1 | loading.tsx + spin animation |
| **3.6** | マルチカラー対応検証 | フロントエンド | 1h | - | 技術検証レポート |
| **3.7** | Storybook作成 | フロントエンド | 2h | 1.5, 2.2, 3.1 | icons.stories.tsx |

#### 特殊ケース対応

| ケース | 対応方法 |
|--------|---------|
| **ロゴがマルチカラー** | `currentColor`を使わず、個別の`fill/stroke`指定を許可 |
| **Faviconの実装** | Next.js 15のApp Router規約（`app/icon.tsx`）に従う |
| **アニメーション** | `animate-pulse-glow`, `animate-spin`をTailwindで実装 |

#### 成果物チェックリスト

- [ ] トップページでロゴがpulse-glow表示
- [ ] Faviconが複数サイズで生成・配置
- [ ] ローディング画面でspin animation
- [ ] Storybookでアイコンカタログ表示

---

### Phase 4: QA・最適化（Day 5）

**目的**: 品質基準達成とパフォーマンス最適化

#### タスク一覧

| # | タスク | 担当 | 所要時間 | 依存 | 成果物 |
|---|--------|------|---------|------|--------|
| **4.1** | Lighthouse Accessibility監査 | QA | 1h | 全Phase完了 | Lighthouseレポート |
| **4.2** | axe DevTools監査 | QA | 0.5h | 全Phase完了 | axeレポート |
| **4.3** | バンドルサイズ計測 | フロントエンド | 0.5h | 全Phase完了 | Bundle Analyzerレポート |
| **4.4** | Tree-shaking検証 | フロントエンド | 1h | 4.3 | 未使用アイコン除外確認 |
| **4.5** | VoiceOverテスト（iOS） | QA | 1h | 4.1 | VoiceOverテスト結果 |
| **4.6** | コントラスト比検証 | デザイナー | 0.5h | - | Starkレポート |
| **4.7** | パフォーマンス改善 | フロントエンド | 2h | 4.1, 4.3 | 最適化コード |
| **4.8** | ビジュアルリグレッション | QA | 1h | - | Chromaticレポート |

#### 品質ゲート

| 指標 | 目標値 | 測定方法 | 不合格時の対応 |
|------|--------|---------|--------------|
| **Lighthouse A11y** | ≥ 95 | Chrome DevTools | Phase 5で優先修正 |
| **axe Errors** | 0 critical | axe DevTools | 即座に修正（必須） |
| **バンドルサイズ** | < 20KB | Bundle Analyzer | SVGO再実行、不要アイコン削除 |
| **コントラスト比** | ≥ 3:1 | Stark Plugin | 色調整 |
| **VoiceOver** | 全識別可能 | 実機テスト | aria-label追加・修正 |

#### 成果物チェックリスト

- [ ] Lighthouse Accessibility ≥ 95達成
- [ ] axe DevTools 0 critical errors
- [ ] カスタムアイコン合計 < 20KB
- [ ] VoiceOverですべてのアイコン識別可能
- [ ] 色覚異常シミュレーション再検証合格

---

### Phase 5: 最終調整とドキュメント（Day 6）

**目的**: QA指摘事項の修正と利用ドキュメント整備

#### タスク一覧

| # | タスク | 担当 | 所要時間 | 依存 | 成果物 |
|---|--------|------|---------|------|--------|
| **5.1** | QA指摘事項修正 | 全員 | 3h | 4.1-4.8 | 修正コード |
| **5.2** | アイコン利用ガイド作成 | フロントエンド | 1.5h | - | docs/icon_usage_guide.md |
| **5.3** | README更新 | フロントエンド | 0.5h | 5.2 | 更新済みREADME.md |
| **5.4** | コードコメント追加 | 全員 | 1h | - | JSDoc完備コード |
| **5.5** | 最終動作確認 | QA | 1h | 5.1 | 動作確認チェックリスト |
| **5.6** | チーム共有会 | 全員 | 1h | 全完了 | 実装完了報告 |

#### ドキュメント作成内容

**docs/icon_usage_guide.md**:
- IconBaseの使い方
- カスタムアイコンのインポート方法
- アクセシビリティのベストプラクティス
- よくある質問（FAQ）

#### 成果物チェックリスト

- [ ] すべてのQA指摘事項修正完了
- [ ] アイコン利用ガイド作成
- [ ] README更新（アイコンセクション追加）
- [ ] 全コンポーネントにJSDoc追加
- [ ] チーム共有会実施

---

### Buffer: 予備日（Day 7）

**目的**: 遅延の吸収と追加改善

#### 想定される使用ケース

| ケース | 対応内容 |
|--------|---------|
| **Phase 1-5の遅延** | 未完了タスクの完了 |
| **追加バグ発見** | 修正とリグレッションテスト |
| **追加改善要望** | 優先度の高い改善実施 |
| **ドキュメント強化** | 不足しているドキュメント追加 |
| **余裕あり** | リファクタリング、コードレビュー |

---

## 🔀 並列実行マトリクス

### 全期間並行タスク

| タスク | 担当 | 開始 | 終了 | 備考 |
|--------|------|------|------|------|
| **SVG作成（全9個）** | デザイナー | Day 1 | Day 6 | 最優先・最長タスク |
| **svgo最適化** | 自動化 | Day 1 | Day 6 | pre-commitフック |
| **ドキュメント更新** | 全員 | Day 1 | Day 6 | 作業しながら随時 |

### Phase内並列実行

**Phase 2（Day 3）の例**:
```
09:00-11:00  フロントエンドA: 投票画面統合
09:00-11:00  フロントエンドB: ヘッダー・ステータスバー統合（並行）
11:00-12:00  QA: 色覚異常シミュレーション（投票画面完了後）
```

---

## 🔗 依存関係グラフ

### クリティカルパス

```
Phase 0: 仕様確定
    ↓
Phase 1: IconBase完成
    ↓
Phase 2: UI統合（ロビー・投票・ステータス）
    ↓
Phase 3: ブランディング
    ↓
Phase 4: QA・最適化
    ↓
Phase 5: 最終調整
    ↓
Buffer: 予備日
```

### 並列可能パス

```
Phase 0: SVG作成開始 → → → → → → Phase 3: SVG完成（並行継続）
                    ↓
Phase 1: IconBase完成 → Phase 2: UI統合
```

---

## ⚠️ リスク管理マトリクス

### 技術的リスク

| リスク | 影響度 | 確率 | 緩和策 | 検知方法 |
|--------|--------|------|--------|---------|
| **SVG作成遅延** | 🔴 高 | 🟡 中 | Phase 0で全開始、並行実施 | Day 3中間チェック |
| **IconBase仕様変更** | 🟡 中 | 🟢 低 | Phase 0でプロトタイプ検証 | Phase 1開始前レビュー |
| **Tree-shaking失敗** | 🟡 中 | 🟢 低 | 個別ファイルインポート徹底 | Phase 4バンドル計測 |
| **Lighthouse不合格** | 🟡 中 | 🟡 中 | Phase 4で集中対応、Buffer活用 | Phase 4 QA |
| **色覚異常対応不足** | 🔴 高 | 🟢 低 | Phase 2で早期検証 | Figma Color Blind |

### スケジュールリスク

| リスク | 影響度 | 確率 | 緩和策 |
|--------|--------|------|--------|
| **Phase 1-2の遅延** | 🟡 中 | 🟡 中 | 並列実行最大化、Buffer活用 |
| **QA指摘多発** | 🟡 中 | 🟡 中 | Phase 4-5で対応、Buffer予備 |
| **デザイナー不在** | 🔴 高 | 🟢 低 | Phase 0で全SVG着手、外注検討 |

---

## 📈 進捗トラッキング

### 日次レビュー項目

**毎日EOD（End of Day）確認**:
- [ ] 当日計画タスクの完了率
- [ ] 翌日のブロッカー有無
- [ ] SVG作成進捗（目標: 9個 ÷ 6日 = 1.5個/日）
- [ ] 品質ゲート早期チェック（コントラスト、aria-label）

### マイルストーン

| マイルストーン | 期限 | 完了基準 |
|-------------|------|---------|
| **M0: 仕様確定** | Day 1 EOD | IconBase API確定、SVG作成開始 |
| **M1: 基盤完成** | Day 2 EOD | IconBase完成、役割アイコン3個統合 |
| **M2: UI統合完了** | Day 3 EOD | 主要4画面すべてにアイコン表示 |
| **M3: ブランド完成** | Day 4 EOD | ロゴ・Favicon実装完了 |
| **M4: QA合格** | Day 5 EOD | Lighthouse ≥ 95、バンドル < 20KB |
| **M5: 最終承認** | Day 6 EOD | チーム共有会完了、本番デプロイ準備完了 |

---

## ✅ 最終成果物チェックリスト

### コード成果物

- [ ] `/components/ui/icons/icon-base.tsx` 完成版
- [ ] `/components/ui/icons/custom/` 配下に9個のTSXファイル
- [ ] `/components/ui/icons/lucide/index.ts` lucide-react再エクスポート
- [ ] `/components/ui/icons/index.ts` バレルファイル
- [ ] `svgo.config.js` + huskyフック設定
- [ ] `icon-base.test.tsx` ユニットテスト
- [ ] `icons.stories.tsx` Storybook

### SVG成果物

- [ ] `master.svg`, `insider.svg`, `common.svg`（役割）
- [ ] `timer.svg`, `conversation.svg`, `network.svg`（ステータス）
- [ ] `insider-logo-1.svg`, `insider-logo-2.svg`, `insider-logo-3.svg`（ブランディング）
- [ ] すべて < 2KB、currentColor対応、SVGO最適化済み

### ドキュメント成果物

- [ ] `docs/icon_usage_guide.md` 利用ガイド
- [ ] `README.md` 更新（アイコンセクション）
- [ ] JSDocコメント（全コンポーネント）

### 品質成果物

- [ ] Lighthouseレポート（Accessibility ≥ 95）
- [ ] axe DevToolsレポート（0 critical）
- [ ] Bundle Analyzerレポート（< 20KB）
- [ ] 色覚異常シミュレーション結果
- [ ] VoiceOverテスト結果

---

## 🚀 キックオフ準備

### 事前準備（実装開始前）

- [ ] チーム全員が本計画書を精読
- [ ] デザイナー：Figma/Inkscapeの環境準備
- [ ] フロントエンド：開発環境セットアップ（Next.js, TypeScript）
- [ ] QA：テストツール準備（Lighthouse, axe, Chromatic）
- [ ] 全員：[アイコン統合要件定義書](./icon_integration_requirements.md)の熟読

### キックオフミーティング議題（Day 0）

1. プロジェクト目標と成功基準の共有
2. 役割分担の確定
   - デザイナー: SVG作成（全期間）
   - フロントエンドA: IconBase + UI統合
   - フロントエンドB: ブランディング + 統合
   - QA: テスト・検証
3. コミュニケーション方法の確認
   - 日次進捗共有（Slack/Discord）
   - ブロッカー報告フロー
   - コードレビュー体制
4. ツール・リポジトリのアクセス確認

---

## 📚 参考資料

| 資料 | 用途 | 参照タイミング |
|------|------|--------------|
| [アイコン統合要件定義書](./icon_integration_requirements.md) | 全体方針確認 | Day 0, Phase 0 |
| [PNG→SVG変換ガイド](./png_to_svg_conversion_guide.md) | SVG作成手順 | Phase 0-4（デザイナー） |
| [IconBase実装ガイド](./iconbase_implementation_guide.md) | コンポーネント実装 | Phase 1 |
| [実装サマリー](./icon_integration_summary.md) | クイックリファレンス | 全Phase |

---

## 🎯 期待される成果

### 定量的成果

- **アイコン統合率**: 100%（9個すべて）
- **品質スコア**: Lighthouse Accessibility ≥ 95
- **ファイルサイズ**: カスタムアイコン合計 < 20KB
- **アクセシビリティ**: VoiceOver識別率 100%

### 定性的成果

- **視認性向上**: ユーザーが役割を5秒以内に識別可能
- **ブランド強化**: 独自デザインでゲーム体験の一貫性向上
- **保守性向上**: 統一インターフェースで新規アイコン追加が容易
- **開発効率**: Tree-shakingにより不要アイコンを自動除外

---

**実装計画書 終了**

本計画書は、Geminiの専門家レビューを反映し、実現可能性とリスク管理を強化した最適化版です。実装開始前に全員でレビューし、不明点を解消してから着手してください。Day 1のPhase 0が全体の成否を分けるため、仕様確定に十分な時間を確保することを推奨します。

**Good luck with the implementation! 🚀**
